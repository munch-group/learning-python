# Genome-wide association studies
<!-- â˜… -->

## Genetic disease association {-}

## Common disease common variant hypothesis {-}

The common disease common variant (CDCV) hypothesis is a concept in human genetics that seeks to explain the genetic basis of common complex diseases by focusing on the prevalence of common genetic variants in the population. This hypothesis contrasts with the "rare variant" hypothesis, which suggests that rare genetic variants with larger effects play a significant role in disease susceptibility.

Hypothesis Explanation:

The CDCV hypothesis suggests that the genetic susceptibility to many common complex diseases, such as diabetes, heart disease, and certain types of cancer, is primarily influenced by common genetic variants that are present at relatively high frequencies in the population. Common genetic variants are those that occur in more than 1% of the population. These variants are typically single nucleotide polymorphisms (SNPs), where a single DNA base is substituted with another.

According to this hypothesis, multiple common genetic variants, each with a small effect size, collectively contribute to an individual's risk of developing a specific disease. The idea is that these common variants, which are widely distributed in the population, are responsible for a significant portion of the genetic susceptibility to a given disease.

Key Points of the CDCV Hypothesis:

Polygenic Nature: Common complex diseases are often influenced by multiple genetic factors, each with a modest effect size. This polygenic nature suggests that no single genetic variant has a large impact on disease risk.

Complex Inheritance: Common variants contribute to disease risk in a complex manner, influenced by interactions between genes and the environment. This complexity makes it challenging to predict disease risk solely based on genetic information.

Quantitative Trait Loci (QTLs): Common variants associated with disease risk are also often associated with variations in quantitative traits, such as blood pressure or cholesterol levels, which are risk factors for certain diseases.

Genome-Wide Association Studies (GWAS): The CDCV hypothesis has been supported by the findings of genome-wide association studies (GWAS). These studies scan the entire genome for associations between common genetic variants and specific diseases or traits. Many common variants have been identified as having modest effects on disease risk through GWAS.

Statistical Significance: Given the small effect sizes of individual variants, large sample sizes are often required in GWAS to achieve statistical significance. This emphasizes the cumulative impact of multiple variants on disease risk.

Heritability Estimates: The CDCV hypothesis aligns with estimates of heritability for common complex diseases, which suggest that a significant portion of the variation in disease risk can be attributed to genetic factors.

Critiques and Challenges:

While the CDCV hypothesis has provided valuable insights into the genetic basis of common complex diseases, it is not without its criticisms and challenges. Some researchers argue that rare genetic variants with larger effect sizes could also contribute to disease risk and might have been overlooked by traditional GWAS approaches.

In recent years, advancements in sequencing technologies and analysis methods have allowed researchers to explore the role of rare variants in disease susceptibility, blurring the distinction between the CDCV hypothesis and the "rare variant" hypothesis. It's increasingly recognized that both common and rare variants contribute to the overall genetic architecture of complex diseases, and a comprehensive understanding of disease risk requires considering both types of variants.

## Testing association {-}

## Genome-wide association {-}

Introduction:

The completion of the Human Genome Project in 2003 marked a pivotal milestone in the realm of genomics, providing a comprehensive map of human genetic information. Subsequent advancements in high-throughput genotyping and sequencing technologies have ushered in an era of genome-wide association studies (GWAS), enabling researchers to unravel the complex genetic underpinnings of various traits, diseases, and phenotypic variations. Genome-wide association studies have revolutionized our understanding of the genetic basis of multifactorial traits, providing insights into the interplay between genetics, environment, and disease susceptibility. This introduction aims to provide an academic overview of GWAS, elucidating their methodology, significance, challenges, and potential implications in the fields of genetics, medicine, and personalized healthcare.

Methodological Underpinnings of GWAS:
Genome-wide association studies are designed to identify statistically significant associations between genetic variants and phenotypic traits within a population. These genetic variants, typically single nucleotide polymorphisms (SNPs), are distributed across the human genome. The fundamental approach of GWAS involves genotyping a large number of individuals for a multitude of SNPs, followed by a statistical analysis to identify genetic variants that are overrepresented in individuals with a particular trait or condition. This analysis often involves comparing allele frequencies between cases and controls, taking into account potential confounding factors.

Significance and Implications:
The insights garnered from GWAS have provided a remarkable understanding of the genetic basis of various complex traits and diseases, including diabetes, cardiovascular diseases, psychiatric disorders, and cancer susceptibility. By pinpointing specific genetic variants associated with disease risk, GWAS have not only expanded our fundamental knowledge of human genetics but have also identified potential therapeutic targets and pathways that underlie these conditions. Moreover, GWAS findings have paved the way for the development of polygenic risk scores, which offer personalized assessments of disease susceptibility based on an individual's genetic makeup.

Challenges and Limitations:
Despite their transformative impact, GWAS are not without challenges. One of the major limitations is the "missing heritability" phenomenon, where the cumulative effect of identified genetic variants often does not account for the entire heritable component of a trait. Additionally, the identified genetic variants might have modest effect sizes, necessitating the analysis of large sample sizes to achieve statistical significance. The issue of population stratification, where differences in genetic ancestry can lead to spurious associations, requires meticulous consideration in study design and analysis.

Future Directions and Implications:
As GWAS methodologies continue to evolve, integrating data from diverse populations and incorporating functional genomics approaches hold the promise of unraveling the biological mechanisms underlying identified associations. The emergence of large-scale biobanks, coupled with advancements in computational biology and artificial intelligence, is expected to enhance our ability to predict disease risk, identify novel drug targets, and tailor interventions for individuals based on their genetic profiles.

Conclusion:

Genome-wide association studies have emerged as a cornerstone of contemporary genetic research, providing a robust framework for unraveling the intricate relationship between genetic variation and complex traits. Their contributions to our understanding of disease etiology, personalized medicine, and the genetic basis of human diversity are undeniable. However, ongoing efforts to address methodological challenges, expand diverse representation, and decipher the functional relevance of identified variants are crucial for fully capitalizing on the potential of GWAS in shaping the future of genetics and healthcare.

Introduction to Methods Used in Genome-Wide Association Studies

Genome-wide association studies (GWAS) have revolutionized the field of genetics and genomics by enabling researchers to uncover the genetic underpinnings of complex traits and diseases. GWAS involve analyzing a vast number of genetic markers across the entire genome to identify associations between specific genetic variants and traits of interest. This introduction provides an overview of the methods used in GWAS and their significance in unraveling the genetic basis of various traits and conditions.

Genetic Variation and Disease Risk:
Human genetic variation plays a crucial role in determining an individual's susceptibility to various diseases and traits, ranging from common disorders like diabetes and heart disease to more intricate traits such as height or cognitive abilities. GWAS aims to identify the specific genetic variants that contribute to these traits and understand how they influence disease risk or trait expression.

Marker Selection and Genotyping:
In a GWAS, a comprehensive set of genetic markers, typically single nucleotide polymorphisms (SNPs), are selected from across the genome. SNPs are single-letter variations in the DNA sequence that can influence traits. High-throughput genotyping technologies allow researchers to determine the genetic variants present in thousands of individuals simultaneously.

Case-Control or Cohort Design:
GWAS often follow either a case-control or cohort design. In a case-control design, individuals with a specific trait or disease (cases) are compared to individuals without the trait or disease (controls) to identify genetic variants associated with the trait. In a cohort design, a large group of individuals is followed over time to observe the relationship between genetic variants and the development of traits or diseases.

Statistical Analysis:
GWAS involves rigorous statistical analysis to identify associations between genetic variants and traits. The basic approach is to compare the frequency of each genetic variant between cases and controls. Variants that show significantly different frequencies are considered potentially associated with the trait. Various statistical tests, such as chi-square tests or logistic regression, are employed to assess the strength and significance of these associations.

Population Stratification and Confounding:
One challenge in GWAS is population stratification, where differences in genetic ancestry among study participants can lead to false positive associations. To mitigate this, researchers use methods to correct for population structure and confounding factors that might influence the results.

Multiple Testing Correction:
Due to the large number of genetic markers tested, there's a risk of identifying false positives by chance alone. Multiple testing correction methods, such as the Bonferroni correction or false discovery rate control, are employed to account for the increased likelihood of false positives and to determine statistical significance thresholds.

Linkage Disequilibrium and Fine-Mapping:
Genetic variants in close proximity on the same chromosome often exhibit linkage disequilibrium (LD), meaning they are inherited together more frequently than expected by chance. This property allows researchers to pinpoint the region of the genome where the causal variant likely resides. Fine-mapping techniques aim to narrow down the location of the true causal variant within an associated region.

In conclusion, GWAS represent a powerful approach to uncovering the genetic factors influencing traits and diseases. By combining advanced genotyping technologies, robust statistical methods, and meticulous study designs, researchers can identify key genetic variants associated with various conditions, shedding light on the underlying biological mechanisms and paving the way for more personalized approaches to healthcare and disease prevention.
## Do it yourself: Exploring an association with Parkinsons disease {-}

The purpose of this exercise is to expose you to the different kinds of information that are stored in databases relevant to bioinformatics. It takes experience and skill to navigate the user interface of these databases. Here you will see a few of the important ones, but there are many more. I have put a list at the end of this exercise with some additional relevant ones. Browse them at your harts content.

The [MacGuffin](https://en.wikipedia.org/wiki/MacGuffin) of this exercise is Parkinsons disease (PD). Millions of people live with PD, which is a progressive incurable disease affecting the nervous system resulting in shaking, involuntary movement and trouble talking and walking. PD is a complex and multifactorial disease with a heritable component: close relative of people with PD have higher risk. 15% of PD patients have a parent, sibling or child with PD. However, unlike other genetic diseases like cystic fibrosis, where a single gene is responsible, the risk of developing PD is determined by small contributions of many different genes. These genes interact with environmental conditions, such as tobacco smoke. PD symptoms are induced by death certain brain cells in the sunstiantia migraine part of the brain that normally produces the neurotransmitter dopamine.

In the study published in by Do at al. 2011, the authors searched for genes contributing to the risk of developing PD. They genotyped 3,426 PD patients (cases) and 29,624 healthy controls for 522,782 single nucleotide polymorphisms SNPs. A SNP is a position in the genome where the nucleotide differ between individuals in a population because some carry a recent mutation (G) and others carry the ancestral variant (A). Simply put, they considered each of the 522,782 SNPs to see if the occurrence of one of the alleles was significantly more often found among the individuals with PD than among healthy controls. Knowing only the number of cases and controls and the total numbers of A and G alleles, the expected number of A and G alleles found among cases and controls can be computed (E.g. the expected number of cases with the A allele is $(3426 * 23615) / 33050 \approx 2448$):

|---:|---:|---:|---:|
|   |  **A**   | **G** | Totals | 
| *Cases* | **2448**   | **978** | 3426 |
| *Controls* | **21167** | **8456** | 29624 |
| Totals | 23615 | 9434 | 33050 | 

This corresponds to an expected frequency of Allele A of 40% in both cases and controls. In the study the they observed the following numbers in each group;

|---:|---:|---:|---:|
|   | *Allele 1*   | *Allele 2* | Totals | 
| *Cases* | **2320**   | **1106** | 3426 |
| *Controls* | **21295** | **8328** | 29624 |
| Totals | 23615 | 9434 | 33050 | 
  
Corresponding to a 48% frequency of allele A among cases and a  39% frequency among controls. To test the statistical significance of this deviation from the expectation, we can perform a [Chi-square test](https://en.wikipedia.org/wiki/Chi-squared_test)to compute the p-value for the above case. The test statistic is very simple:

$$ \sum \frac{(observed - expected)^2}{expected} $$

Under the null-hypothesis, the test statistic follows a chi-square distribution with 1 degree of freedom. You can even do this in Python using the `chi2_contingency` from the `script.stats` library. Try it out and see what the p-value is in this case:

```python
from scipy.stats import chi2_contingency
observed = [[2320, 1106],
			[21295, 8328]]
stat, p_value, deg_free, expected = chi2_contingency(observed, correction=False)
print(p_value)
```

The p-value is probably something like 3e-07, which you may think is really small. Normally we use 0.05 as our significance cutoff - the probability of wrongly rejecting our null hypothesis of no association. Since there is a 0.05 probably in every test, we need to divide our significance cutoff by the number of tests to get the significance cutoff needed to only wrongly reject the null-hypothesis with 0.05 probability after doing all 522,782 tests. This cutoff is $0.05 / 522782 = 9.56e-08$. This adjustment of the significance cutoff is called [Bonferroni correction](https://en.wikipedia.org/wiki/Bonferroni_correction) overcorrects a bit, but the correction shows that even p-values as low as the one you computed above is only just significant in a GWAS. 

That is pretty much what GWAS is. There are some additional nuts and bolts required to take biases into account. Accounting for cases and controls not being sampled in the same way. You can probably imagine why the SNPs determining eye color would show up as associated with PD if all cases were sampled in Spain and all controls in Finland. However, we will gloss over those details here.

The SNPs associated with PD are not themselves involved in PD, but they mark a genomic neighborhood that is inherited along with the SNP. The closer a gene is to an associated SNP, the more likely it is that the gene is inherited along with the SNP. So it this genomic neighborhood that we should search for genes playing a role in the development of PD. Such candidate genes must be identified for new insights into causes of the disease and how it can be treated. The following part the of the exercise, but is meant to take you though some of the motions that a scientist would go through to search relevant genes in the region. 

- Each known SNP has a unique accession number that identifies it.
- The SNP identified by Do et al. has accession number *rs11868035*
- To explore the genomic neighbourhood of this SNP we use the [UCSC genome browser](https://genome-euro.ucsc.edu/cgi-bin/hgGateway?redirect=manual&source=genome.ucsc.edu). 
- The genome browser saves your preferences across sessions so if you have tried this service before before you can reset the browser to the default settings to align the views with this exercise. Click the Genome Browser->Reset All User Settings option in the top menu bar. However, be aware that this action will remove all custom tracks and will clear all track filter and configuration settings that may have modified.
- Under "Find Position" select the most recent human genome assembly (hg38) and paste in rs11868035 under "Position/Search Term" and click GO.
- On the resulting listing click the top link under "NHGRI-EBI Catalog of Published Genome-Wide Association Studies". 
- Familiarise yourself with the browser view. 
- Notice the SNP shown in the middle of the "NHGRI-EBI Catalog of Published Genome-Wide Association Studies" track. 
- Notice the scale shown at the top of the view. What part of the genome is shown? The chromosome ideogram at the top also shows with a red marker what part of the chromosome is shown. Use the zoom buttons to zoom out so you can see a see roughly 1,000 kilobases (1,000,000 base pairs) of the genome.
- The view is divided into tracks. Mousing over the right margin of each track will highlight it in green, and right-clicking will show customisation settings for each track. By holding and dragging on the grey bars furthest to the right, you can even reorder tracks as you please. 
- Scrolling down below the view, you can see a large number of tracks you can enable to show in the view. 
- In the "Phenotype and Literature" section find the dropdown labelled OMIM Genes and chose the view mode "Pack". Similarly, in the "Expression" section find and enable the track called GNF Atlas 2. Finally, "Mapping and Sequencing", find the Publications track and choose the "Dense" view mode. Now click any of the "Refresh" buttons to update the view with the selected tracks.
- If you click the grey bar on the right of each track, you are redirected to a page explaining the track.

- 

> In part I of the exercise, the UCSC "Genes" track has been replaced by "GENCODE v29". If you do not see the "GENCODE v29" track or the "RefSeq Genes" and "Human mRNAs" tracks, scroll down to the drop-down menus under "Gene and Gene Predictions" and select "GENCODE v29" and "NCBI RefSeq". The "Human mRNAs" track can be found under "mRNA and EST". Unfortunately, the GAD view and the Publications track are no longer available.


**Have them read a GWAS review**

Part of the exercise could be to make chi-square tests for the subset of SNPs in the region to see if they get something similar to 

```python
import matplotlib.pyplot as plt

pvalues = [1,2,3]
coordinates = [1,2,1]
plt.scatter(pvalues, coordinates)
plt.title('Plot 1')
plt.show()

pvalues = [1,2,3]
coordinates = [1,2,3]
plt.scatter(pvalues, coordinates)
plt.title('Plot 2')
plt.show()
```